<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Home</title>
    
    <link rel="stylesheet" href="public/css/home.css">
    <!-- FullCalendar CSS -->
    <link href="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.0/main.min.css" rel="stylesheet" />
    <link href="public/bootstrap-5.2.3-dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="public/fontawesome-free-6.2.1-web/css/all.css" rel="stylesheet" />
    <link href="public/css/carousel.css" rel="stylesheet">
    <link href="public/css/noti.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">


    <style>
        /* กำหนดสีพื้นหลังและขอบการ์ด */
        .card-custom {
            background-color: #f0f8ff; /* สีฟ้าอ่อน */
            border: 2px solid #aeb0b3; /* ขอบสีฟ้าเข้ม */
            border-radius: 10px;
        }
        .card-title {
            color: #007bff; /* สีน้ำเงิน */
            font-weight: bold;
        }
    </style>
  
    <style>
        .dashboard-card {
            background-color: #f8f9fa;
            border: 1px solid #ddd;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        .btn {
            background-color: #3d216b;
            color: #f8dc3e;
            border: 1px solid #ddd; 
            
            border-radius: 120px;
            margin-bottom: 20px;  
        }
        .card-title {
            color: #3d216b;
            font-weight: bold;
        }
        .calendar {
            height: 500px;
            background-color: #aeb0b3;
            border-radius: 10px;
            /* padding: 10px; */
        }
        .profile-pic {
            width: 80px;
            height: 80px;
            border-radius: 50%;
        }
        .dropdown-menu {
            max-height: 300px;
            overflow-y: auto;
        }

    </style>

    
</head>
<body>
  <header>
    <nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark">
        <a href="#" class="navbar-brand"><i class="fa fa-cube"></i> สวัสดีคุณ <%= user %></a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarCollapse">
            <div class="navbar-nav ml-auto">
                <a href="/home" class="nav-item nav-link"><i class="fa fa-home"></i> หน้าหลัก</a>
                <a href="/leave-request-form" class="nav-item nav-link"><i class="fa fa-file-alt"></i> ยื่นคำขอลา</a>
                <a href="/leave-request-pending" class="nav-item nav-link"><i class="fa fa-file-alt"></i> รายการลา</a>
                <a href="/leave-request-cancel" class="nav-item nav-link"><i class="fas fa-times-circle "></i> ยกเลิกคำขอลา</a>
                <a href="/leave-history" class="nav-item nav-link"><i class="fa fa-history"></i> ประวัติการลา</a>
                <a href="/leave-approvals" class="nav-item nav-link"><i class="fa fa-check-circle"></i> การอนุมัติหรือปฏิเสธคำขอ</a>
                <a href="/leave-balance" class="nav-item nav-link"><i class="fa fa-calculator"></i> คำนวณวันลาคงเหลือ</a>
                <a href="/dashboard" class="nav-item nav-link"><i class="fa fa-users"></i> เจ้าหน้าที่ทั้งหมด</a>
                <a href="/notifications" class="nav-item nav-link"><i class="fa fa-envelope"></i> ข้อความ
                    
                </a>
                
                
                <!-- Dropdown Menu for Logout -->
                <div class="nav-item dropdown">
                    <a href="#" class="nav-link dropdown-toggle" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                        <i class="fa fa-sign-out-alt"></i> ออกจากระบบ
                    </a>
                    <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                        <li><a class="dropdown-item" href="/leave-profile"><i class="fa fa-user"></i> โปรไฟล์ของฉัน</a></li>
                        <li><a class="dropdown-item" href="/leave-settings"><i class="fa fa-cog"></i> ตั้งค่า</a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><a class="dropdown-item" href="/logout"><i class="fa fa-sign-out-alt"></i> ออกจากระบบ</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </nav>
    
  </header>
  <main role="main">
    <div class="container mt-5">
        <!-- Carousel Section -->
        <div id="carouselExampleIndicators" class="carousel slide mb-4" data-bs-ride="carousel">
            <div class="carousel-indicators">
                <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
                <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="1" aria-label="Slide 2"></button>
                <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="2" aria-label="Slide 3"></button>
            </div>
            <div class="carousel-inner">
                <div class="carousel-item active">
                    <img src="data:image/gif;base64,R0lGODlhAQABAIAAAHd3dwAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw=="  class="d-block w-100" alt="Slide 1">
                    <div class="carousel-caption d-none d-md-block">
                        <h5>ข่าวสารบริษัท</h5>
                        <p>ประกาศข่าวสารล่าสุดจากบริษัท</p>
                    </div>
                </div>
                <div class="carousel-item">
                    <img src="data:image/gif;base64,R0lGODlhAQABAIAAAHd3dwAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw=="  class="d-block w-100" alt="Slide 2">
                    <div class="carousel-caption d-none d-md-block">
                        <h5>กิจกรรมประจำปี</h5>
                        <p>ร่วมสนุกกับกิจกรรมที่จัดโดยบริษัท</p>
                    </div>
                </div>
                <div class="carousel-item">
                    <img src="data:image/gif;base64,R0lGODlhAQABAIAAAHd3dwAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==" class="d-block w-100" alt="Slide 3">
                    <div class="carousel-caption d-none d-md-block">
                        <h5>โปรโมชันและสิทธิประโยชน์</h5>
                        <p>รับสิทธิประโยชน์พิเศษสำหรับพนักงาน</p>
                    </div>
                </div>
            </div>
            <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Previous</span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Next</span>
            </button>
        </div>

        <div class="row">
            <!-- User Information Summary -->
            <div class="col-md-3">
                <% user_detail.forEach(request => { %>
                <div class="dashboard-card">
                    <div class="text-center">
                        <img src="public/img/profile-placeholder.png" class="profile-pic" alt="Profile Picture">
                    </div>
                    <h5 class="text-center mt-3">ชื่อผู้ใช้งาน : <%= user %></h5>
                    <p class="text-center">ตำแหน่ง: <%= request.position %>  </p>
                    <p class="text-center">แผนก: <%= request.department %> </p>
                    <hr>

                    <h6>สิทธิการลา</h6>
                    <ul class="list-unstyled">
                        <li>ลาพักร้อน: 10 วัน</li>
                        <li>ลาป่วย: 5 วัน</li>
                        <li>ลากิจ: 3 วัน</li>
                    </ul>
                </div>
                <% }); %>
                <div class="dashboard-card">
                    <h6 class="card-title">ทางลัดการทำงาน</h6>
                    <button class="btn btn-block mb-2">ยื่นคำขอลา</button>
                    <button class="btn btn-block">ดูคำขอลาทั้งหมด</button>
                </div>
            </div>

            

            <div class="collapse navbar-collapse" id="results">
            </div>
            
            
            <!-- Pending Leave Requests (ยังคงเดิม) -->
            <div class="col-md-6">
                <div class="dashboard-card">
                    <h6 class="card-title">คำขอลาที่อยู่ระหว่างดำเนินการ</h6>
                    <ul class="list-group">
                        <li class="list-group-item">รอการอนุมัติ: 2023-10-13 ถึง 2023-10-14 (ลาพักร้อน)</li>
                        <li class="list-group-item">อนุมัติแล้ว: 2023-09-10 ถึง 2023-09-12 (ลากิจ)</li>
                    </ul>
                </div>

                <!-- ปฏิทินการทำงาน -->
                <div class="dashboard-card">
                    <h6 class="card-title">ปฏิทินการทำงาน</h6>
                    <div id="calendar" class="calendar"></div> <!-- ปฏิทินจะแสดงที่นี่ -->
                </div>
            </div>

            <!-- Announcements, Statistics, Quick Actions -->
            <div class="col-md-3">
                <div class="dashboard-card">
                    <h6 class="card-title">ประกาศและข่าวสาร</h6>
                    <p>ประกาศ: วันหยุดพิเศษวันที่ 2024-10-20</p>
                    <p>ข่าวสาร: กิจกรรมองค์กรประจำปี</p>
                </div>
                <div class="dashboard-card">
                    <h6 class="card-title">สถิติการใช้งาน</h6>
                    <div class="stat-item">
                        <p>ลาทั้งหมดในปีนี้</p>
                        <h4>12 วัน</h4>
                    </div>
                </div>
                <div class="dashboard-card">
                    <h6 class="card-title">ทางลัดการทำงาน</h6>
                    <button class="btn btn-block mb-2">ยื่นคำขอลา</button>
                    <button class="btn btn-block">ดูคำขอลาทั้งหมด</button>
                </div>
            </div>
        </div>
    </div>
     <!-- FullCalendar Scripts -->
     <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.0/main.min.js"></script>
     <script>
         document.addEventListener('DOMContentLoaded', function() {
             var calendarEl = document.getElementById('calendar');
             var calendar = new FullCalendar.Calendar(calendarEl, {
                 initialView: 'dayGridMonth',
                 events: [
                     {
                         title: 'ลาพักร้อน',
                         start: '2024-10-13',
                         end: '2024-10-14'
                     },
                     {
                         title: 'ลากิจ',
                         start: '2024-09-10',
                         end: '2024-09-12'
                     },
                     {
                         title: 'วันหยุดพิเศษ',
                         start: '2024-10-20'
                     }
                 ]
             });
             calendar.render();
         });
     </script>
     <script>
       
    document.querySelectorAll('.dropdown-item').forEach(item => {
        item.addEventListener('click', () => {
            const notificationId = item.getAttribute('data-id'); // ตั้งค่า id สำหรับแจ้งเตือนแต่ละอัน
            fetch(`/notifications/${notificationId}/mark-read`, { method: 'POST' })
                .then(response => response.json())
                .then(data => {
                    if (data.status === 'success') {
                        console.log('Notification marked as read');
                    }
                });
        });
    });
</script>


     </script>

  </main> 

 


  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js"></script>
    <script src="public/js/showNotification.js"></script>
    <script src="public/js/jquery-3.4.1.slim.min.js"></script>
    <script src="public/bootstrap-5.2.3-dist/js/bootstrap.min.js"></script>
    <script src="public/js/sweetalert2.all.min.js"></script>
    
</body>
</html>  